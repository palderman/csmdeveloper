#' @export
build_cloud <- function(cx, cy, size, asp = sqrt(2)){
  xy <- structure(list(x = c(2.40123126789898, 2.42926042606282, 2.45656820967267,
                             2.483108727845, 2.50883737909013, 2.53371092626531, 2.55768756923499,
                             2.58072701511615, 2.60279054599076, 2.6238410839714, 2.64384325351092,
                             2.66276344085119, 2.68056985051127, 2.69723255871982, 2.71272356370224,
                             2.72701683273775, 2.74008834590755, 2.75191613646044, 2.76248032772805,
                             2.77176316652769, 2.77974905299668, 2.78642456680801, 2.79177848972329,
                             2.795801824445, 2.79848780973659, 2.79983193178471, 2.79983193178471,
                             2.79848780973659, 2.795801824445, 2.79177848972329, 2.78642456680801,
                             2.77974905299668, 2.77176316652769, 2.76248032772805, 2.75191613646044,
                             2.74008834590755, 2.72701683273775, 2.71272356370224, 2.69723255871982,
                             2.68056985051127, 2.66276344085119, 2.64384325351092, 2.6238410839714,
                             2.60279054599076, 2.58072701511615, 2.55768756923499, 2.53371092626531,
                             2.50883737909013, 2.483108727845, 2.45656820967267, 2.42926042606282,
                             2.40123126789898, 2.40123126789898, 2.39511115601506, 2.38805825491505,
                             2.38008103077243, 2.37118905930112, 2.361393014261, 2.35070465464533,
                             2.33913681056548, 2.32670336784986, 2.31341925137566, 2.29930040715326,
                             2.284363783185, 2.26862730912105, 2.25210987473698, 2.23483130725888,
                             2.21681234756307, 2.19807462527911, 2.17864063282608, 2.15853369841298,
                             2.13777795803607, 2.1163983265064, 2.09442046754253, 2.07187076296433,
                             2.04877628102465, 2.02516474391714, 2.00106449449899, 1.97650446226873,
                             1.95151412863976, 1.9261234915514, 1.90036302945993, 1.8742636647528,
                             1.84785672662994, 1.82117391349681, 1.79424725491417, 1.76710907315039,
                             1.7397919443824, 1.71232865959187, 1.68475218520344, 1.6570956235125,
                             1.62939217294977, 1.6016750882305, 1.57397764043616, 1.54633307707638,
                             1.51877458217932, 1.49133523645809, 1.46404797760134, 1.43694556073542,
                             1.41006051910574, 1.38342512502445, 1.35707135113134, 1.3310308320145,
                             1.30533482623669, 1.30533482623669, 1.28946908476416, 1.27265539928626,
                             1.25491750766305, 1.23628045256527, 1.21677054611864, 1.19641533275593,
                             1.17524355032925, 1.15328508953741, 1.13057095172574, 1.10713320511781,
                             1.08300493954098, 1.05822021970953, 1.03281403713154, 1.00682226070725,
                             0.980281586088708, 0.953229483872174, 0.925704146696493, 0.897744435322039,
                             0.8693898237664, 0.84068034357426, 0.811656527300154, 0.782359351283886,
                             0.752830177799403, 0.723110696658802, 0.693242866353914, 0.663268854818554,
                             0.63323097989509, 0.603171649589354, 0.573133302198268, 0.543158346394705,
                             0.513289101354163, 0.483567737007809, 0.454036214506217, 0.424736226977868,
                             0.395709140666051, 0.366995936527269, 0.338637152373588, 0.310672825640644,
                             0.283142436862068, 0.256084853930177, 0.229538277221584, 0.203540185665236,
                             0.178127283828986, 0.15333545009944, 0.12919968602821, 0.105754066916097,
                             0.0830316937049821, 0.0610646462453259, 0.0398839380052631, 0.0195194722852396,
                             2.22044604925031e-16, 1.11022302462516e-16, -0.0195194722852394,
                             -0.0398839380052628, -0.0610646462453256, -0.0830316937049819,
                             -0.105754066916096, -0.129199686028209, -0.15333545009944, -0.178127283828986,
                             -0.203540185665235, -0.229538277221584, -0.256084853930176, -0.283142436862068,
                             -0.310672825640644, -0.338637152373588, -0.366995936527268, -0.395709140666051,
                             -0.424736226977867, -0.454036214506217, -0.483567737007809, -0.513289101354163,
                             -0.543158346394704, -0.573133302198268, -0.603171649589354, -0.63323097989509,
                             -0.663268854818554, -0.693242866353914, -0.723110696658802, -0.752830177799403,
                             -0.782359351283886, -0.811656527300154, -0.84068034357426, -0.8693898237664,
                             -0.897744435322039, -0.925704146696493, -0.953229483872174, -0.980281586088708,
                             -1.00682226070725, -1.03281403713154, -1.05822021970953, -1.08300493954098,
                             -1.10713320511781, -1.13057095172574, -1.15328508953741, -1.17524355032925,
                             -1.19641533275593, -1.21677054611864, -1.23628045256527, -1.25491750766305,
                             -1.27265539928626, -1.28946908476416, -1.30533482623669, -1.30533482623669,
                             -1.3310308320145, -1.35707135113134, -1.38342512502445, -1.41006051910574,
                             -1.43694556073542, -1.46404797760134, -1.49133523645809, -1.51877458217931,
                             -1.54633307707638, -1.57397764043616, -1.6016750882305, -1.62939217294976,
                             -1.6570956235125, -1.68475218520344, -1.71232865959187, -1.7397919443824,
                             -1.76710907315039, -1.79424725491417, -1.82117391349681, -1.84785672662994,
                             -1.8742636647528, -1.90036302945993, -1.9261234915514, -1.95151412863975,
                             -1.97650446226873, -2.00106449449899, -2.02516474391714, -2.04877628102465,
                             -2.07187076296433, -2.09442046754253, -2.1163983265064, -2.13777795803607,
                             -2.15853369841298, -2.17864063282608, -2.19807462527911, -2.21681234756306,
                             -2.23483130725888, -2.25210987473698, -2.26862730912105, -2.284363783185,
                             -2.29930040715326, -2.31341925137566, -2.32670336784986, -2.33913681056548,
                             -2.35070465464533, -2.361393014261, -2.37118905930111, -2.38008103077243,
                             -2.38805825491505, -2.39511115601506, -2.40123126789898, -2.40123126789898,
                             -2.42926042606282, -2.45656820967267, -2.483108727845, -2.50883737909013,
                             -2.53371092626531, -2.55768756923499, -2.58072701511615, -2.60279054599076,
                             -2.6238410839714, -2.64384325351091, -2.66276344085119, -2.68056985051127,
                             -2.69723255871982, -2.71272356370224, -2.72701683273775, -2.74008834590755,
                             -2.75191613646044, -2.76248032772805, -2.77176316652769, -2.77974905299668,
                             -2.78642456680801, -2.79177848972329, -2.795801824445, -2.79848780973659,
                             -2.79983193178471, -2.79983193178471, -2.79848780973659, -2.795801824445,
                             -2.79177848972329, -2.78642456680801, -2.77974905299668, -2.77176316652769,
                             -2.76248032772805, -2.75191613646044, -2.74008834590755, -2.72701683273775,
                             -2.71272356370224, -2.69723255871982, -2.68056985051127, -2.66276344085119,
                             -2.64384325351092, -2.6238410839714, -2.60279054599076, -2.58072701511615,
                             -2.55768756923499, -2.53371092626531, -2.50883737909013, -2.483108727845,
                             -2.45656820967267, -2.42926042606282, -2.40123126789898, -2.40123126789898,
                             -2.39511115601506, -2.38805825491505, -2.38008103077243, -2.37118905930112,
                             -2.361393014261, -2.35070465464533, -2.33913681056548, -2.32670336784986,
                             -2.31341925137566, -2.29930040715326, -2.284363783185, -2.26862730912105,
                             -2.25210987473698, -2.23483130725888, -2.21681234756307, -2.19807462527911,
                             -2.17864063282608, -2.15853369841298, -2.13777795803607, -2.1163983265064,
                             -2.09442046754253, -2.07187076296433, -2.04877628102465, -2.02516474391714,
                             -2.00106449449899, -1.97650446226873, -1.95151412863975, -1.9261234915514,
                             -1.90036302945993, -1.8742636647528, -1.84785672662994, -1.82117391349681,
                             -1.79424725491417, -1.76710907315039, -1.7397919443824, -1.71232865959187,
                             -1.68475218520344, -1.6570956235125, -1.62939217294977, -1.6016750882305,
                             -1.57397764043616, -1.54633307707638, -1.51877458217932, -1.49133523645809,
                             -1.46404797760134, -1.43694556073542, -1.41006051910574, -1.38342512502445,
                             -1.35707135113134, -1.3310308320145, -1.30533482623669, -1.30533482623669,
                             -1.28946908476416, -1.27265539928626, -1.25491750766305, -1.23628045256527,
                             -1.21677054611864, -1.19641533275593, -1.17524355032925, -1.15328508953741,
                             -1.13057095172574, -1.10713320511781, -1.08300493954098, -1.05822021970953,
                             -1.03281403713154, -1.00682226070725, -0.980281586088709, -0.953229483872174,
                             -0.925704146696494, -0.89774443532204, -0.8693898237664, -0.84068034357426,
                             -0.811656527300155, -0.782359351283887, -0.752830177799403, -0.723110696658803,
                             -0.693242866353914, -0.663268854818555, -0.633230979895091, -0.603171649589355,
                             -0.573133302198269, -0.543158346394705, -0.513289101354163, -0.48356773700781,
                             -0.454036214506218, -0.424736226977868, -0.395709140666052, -0.366995936527269,
                             -0.338637152373589, -0.310672825640644, -0.283142436862069, -0.256084853930177,
                             -0.229538277221585, -0.203540185665236, -0.178127283828987, -0.153335450099441,
                             -0.12919968602821, -0.105754066916097, -0.0830316937049828, -0.0610646462453264,
                             -0.0398839380052637, -0.0195194722852402, -6.66133814775094e-16,
                             -3.33066907387547e-16, 0.0195194722852392, 0.0398839380052626,
                             0.0610646462453254, 0.0830316937049816, 0.105754066916096, 0.129199686028209,
                             0.15333545009944, 0.178127283828986, 0.203540185665235, 0.229538277221584,
                             0.256084853930176, 0.283142436862068, 0.310672825640643, 0.338637152373588,
                             0.366995936527268, 0.395709140666051, 0.424736226977868, 0.454036214506217,
                             0.483567737007809, 0.513289101354162, 0.543158346394704, 0.573133302198268,
                             0.603171649589354, 0.63323097989509, 0.663268854818554, 0.693242866353914,
                             0.723110696658802, 0.752830177799403, 0.782359351283886, 0.811656527300154,
                             0.84068034357426, 0.8693898237664, 0.897744435322039, 0.925704146696493,
                             0.953229483872174, 0.980281586088708, 1.00682226070725, 1.03281403713154,
                             1.05822021970953, 1.08300493954098, 1.10713320511781, 1.13057095172574,
                             1.15328508953741, 1.17524355032925, 1.19641533275593, 1.21677054611864,
                             1.23628045256527, 1.25491750766305, 1.27265539928626, 1.28946908476416,
                             1.30533482623669, 1.30533482623669, 1.3310308320145, 1.35707135113134,
                             1.38342512502445, 1.41006051910574, 1.43694556073542, 1.46404797760134,
                             1.49133523645809, 1.51877458217931, 1.54633307707638, 1.57397764043616,
                             1.6016750882305, 1.62939217294977, 1.6570956235125, 1.68475218520344,
                             1.71232865959187, 1.7397919443824, 1.76710907315039, 1.79424725491417,
                             1.82117391349681, 1.84785672662994, 1.8742636647528, 1.90036302945993,
                             1.9261234915514, 1.95151412863975, 1.97650446226873, 2.00106449449899,
                             2.02516474391714, 2.04877628102465, 2.07187076296433, 2.09442046754253,
                             2.1163983265064, 2.13777795803607, 2.15853369841298, 2.17864063282608,
                             2.19807462527911, 2.21681234756307, 2.23483130725888, 2.25210987473698,
                             2.26862730912105, 2.284363783185, 2.29930040715326, 2.31341925137566,
                             2.32670336784986, 2.33913681056548, 2.35070465464533, 2.361393014261,
                             2.37118905930112, 2.38008103077243, 2.38805825491505, 2.39511115601506,
                             2.40123126789898), y = c(-0.692107989883211, -0.675081836977094,
                                                      -0.656921205256985, -0.637656613766364, -0.617320436759298, -0.595946849295326,
                                                      -0.573571769808078, -0.550232799744149, -0.525969160373653, -0.500821626878663,
                                                      -0.474832459830285, -0.448045334169533, -0.420505265811346, -0.392258535995088,
                                                      -0.363352613508669, -0.33383607491698, -0.303758522928699, -0.273170503038668,
                                                      -0.242123418585897, -0.210669444369972, -0.178861438971009, -0.14675285592051,
                                                      -0.11439765387241, -0.0818502059252493, -0.049165208247883, -0.0163975881622579,
                                                      0.0163975881622581, 0.0491652082478829, 0.0818502059252494, 0.11439765387241,
                                                      0.146752855920511, 0.178861438971009, 0.210669444369973, 0.242123418585897,
                                                      0.273170503038668, 0.3037585229287, 0.33383607491698, 0.363352613508669,
                                                      0.392258535995088, 0.420505265811346, 0.448045334169533, 0.474832459830285,
                                                      0.500821626878663, 0.525969160373653, 0.550232799744149, 0.573571769808078,
                                                      0.595946849295326, 0.617320436759298, 0.637656613766364, 0.656921205256985,
                                                      0.675081836977094, 0.692107989883211, 0.69210798988321, 0.719141090383363,
                                                      0.745945957072021, 0.772490413877566, 0.798742597319642, 0.824670994757491,
                                                      0.850244482217151, 0.875432361752106, 0.900204398292538, 0.924530855938952,
                                                      0.948382533656607, 0.971730800327902, 0.99454762912065, 1.01680563113097,
                                                      1.03847808826042, 1.05953898528793, 1.079963041098, 1.09972573902764,
                                                      1.11880335629581, 1.13717299247972, 1.15481259700416, 1.17170099561053,
                                                      1.1878179157741, 1.20314401103874, 1.21766088424007, 1.23135110958906,
                                                      1.24419825358964, 1.25618689476518, 1.26730264217012, 1.27753215266462,
                                                      1.28686314693143, 1.29528442421571, 1.30278587577028, 1.30935849698992,
                                                      1.31499439822034, 1.31968681422882, 1.32343011232502, 1.32621979912238,
                                                      1.3280525259319, 1.32892609278185, 1.32883945105856, 1.32779270476517,
                                                      1.32578711039679, 1.32282507543221, 1.318910155444, 1.31404704983051,
                                                      1.30824159617475, 1.30150076323708, 1.29383264259006, 1.28524643890542,
                                                      1.27575245890501, 1.26536209898872, 1.26536209898872, 1.2908932882579,
                                                      1.315810418081, 1.34007831001118, 1.36366270220716, 1.38653029780475,
                                                      1.40864881192596, 1.42998701725931, 1.45051478814717, 1.47020314311766,
                                                      1.4890242858012, 1.50695164417395, 1.52395990807265, 1.54002506492795,
                                                      1.55512443366579, 1.56923669672895, 1.58234193017356, 1.59442163179804,
                                                      1.60545874726489, 1.61543769417827, 1.62434438408354, 1.63216624235752,
                                                      1.63889222596166, 1.64451283903273, 1.64902014628927, 1.65240778423477,
                                                      1.65467097014174, 1.65580650880409, 1.65581279704814, 1.65468982599605,
                                                      1.65243918107831, 1.64906403979543, 1.64456916723186, 1.63896090932862,
                                                      1.6322471839239, 1.6244374695746, 1.61554279217426, 1.60557570938659,
                                                      1.59455029291625, 1.58248210864222, 1.56938819464162, 1.55528703713501,
                                                      1.54019854438725, 1.52414401860066, 1.50714612584014, 1.4892288640329,
                                                      1.47041752908769, 1.4507386791816, 1.4302200972648, 1.40889075183601,
                                                      1.3867807560443, 1.36392132517481, 1.36392132517481, 1.3867807560443,
                                                      1.40889075183601, 1.4302200972648, 1.4507386791816, 1.47041752908769,
                                                      1.4892288640329, 1.50714612584014, 1.52414401860066, 1.54019854438726,
                                                      1.55528703713501, 1.56938819464162, 1.58248210864222, 1.59455029291625,
                                                      1.60557570938659, 1.61554279217426, 1.6244374695746, 1.6322471839239,
                                                      1.63896090932862, 1.64456916723186, 1.64906403979543, 1.65243918107831,
                                                      1.65468982599605, 1.65581279704814, 1.65580650880409, 1.65467097014174,
                                                      1.65240778423477, 1.64902014628927, 1.64451283903273, 1.63889222596166,
                                                      1.63216624235752, 1.62434438408354, 1.61543769417827, 1.60545874726489,
                                                      1.59442163179804, 1.58234193017356, 1.56923669672895, 1.55512443366579,
                                                      1.54002506492795, 1.52395990807265, 1.50695164417395, 1.4890242858012,
                                                      1.47020314311766, 1.45051478814717, 1.42998701725931, 1.40864881192596,
                                                      1.38653029780475, 1.36366270220716, 1.34007831001118, 1.315810418081,
                                                      1.2908932882579, 1.26536209898872, 1.26536209898872, 1.27575245890501,
                                                      1.28524643890542, 1.29383264259006, 1.30150076323708, 1.30824159617475,
                                                      1.31404704983051, 1.318910155444, 1.32282507543221, 1.32578711039679,
                                                      1.32779270476518, 1.32883945105856, 1.32892609278185, 1.3280525259319,
                                                      1.32621979912238, 1.32343011232502, 1.31968681422882, 1.31499439822034,
                                                      1.30935849698992, 1.30278587577028, 1.29528442421571, 1.28686314693143,
                                                      1.27753215266462, 1.26730264217012, 1.25618689476518, 1.24419825358964,
                                                      1.23135110958906, 1.21766088424007, 1.20314401103874, 1.1878179157741,
                                                      1.17170099561053, 1.15481259700416, 1.13717299247972, 1.11880335629581,
                                                      1.09972573902764, 1.079963041098, 1.05953898528793, 1.03847808826042,
                                                      1.01680563113097, 0.994547629120651, 0.971730800327903, 0.948382533656608,
                                                      0.924530855938953, 0.900204398292539, 0.875432361752107, 0.850244482217152,
                                                      0.824670994757492, 0.798742597319643, 0.772490413877567, 0.745945957072022,
                                                      0.719141090383364, 0.692107989883211, 0.692107989883211, 0.675081836977094,
                                                      0.656921205256985, 0.637656613766364, 0.617320436759298, 0.595946849295326,
                                                      0.573571769808079, 0.550232799744149, 0.525969160373654, 0.500821626878664,
                                                      0.474832459830286, 0.448045334169534, 0.420505265811346, 0.392258535995088,
                                                      0.36335261350867, 0.333836074916981, 0.3037585229287, 0.273170503038668,
                                                      0.242123418585897, 0.210669444369973, 0.17886143897101, 0.146752855920511,
                                                      0.11439765387241, 0.0818502059252497, 0.0491652082478833, 0.0163975881622583,
                                                      -0.0163975881622576, -0.0491652082478827, -0.0818502059252489,
                                                      -0.11439765387241, -0.14675285592051, -0.178861438971009, -0.210669444369972,
                                                      -0.242123418585897, -0.273170503038667, -0.303758522928699, -0.33383607491698,
                                                      -0.363352613508669, -0.392258535995087, -0.420505265811345, -0.448045334169533,
                                                      -0.474832459830285, -0.500821626878663, -0.525969160373653, -0.550232799744149,
                                                      -0.573571769808078, -0.595946849295326, -0.617320436759298, -0.637656613766364,
                                                      -0.656921205256985, -0.675081836977094, -0.692107989883211, -0.692107989883211,
                                                      -0.719141090383364, -0.745945957072021, -0.772490413877567, -0.798742597319643,
                                                      -0.824670994757492, -0.850244482217152, -0.875432361752107, -0.900204398292538,
                                                      -0.924530855938952, -0.948382533656607, -0.971730800327903, -0.99454762912065,
                                                      -1.01680563113097, -1.03847808826042, -1.05953898528793, -1.079963041098,
                                                      -1.09972573902764, -1.11880335629581, -1.13717299247972, -1.15481259700416,
                                                      -1.17170099561053, -1.1878179157741, -1.20314401103874, -1.21766088424007,
                                                      -1.23135110958906, -1.24419825358964, -1.25618689476518, -1.26730264217012,
                                                      -1.27753215266462, -1.28686314693143, -1.29528442421571, -1.30278587577028,
                                                      -1.30935849698992, -1.31499439822034, -1.31968681422882, -1.32343011232502,
                                                      -1.32621979912238, -1.3280525259319, -1.32892609278185, -1.32883945105856,
                                                      -1.32779270476517, -1.32578711039679, -1.32282507543221, -1.318910155444,
                                                      -1.31404704983051, -1.30824159617475, -1.30150076323708, -1.29383264259006,
                                                      -1.28524643890542, -1.27575245890501, -1.26536209898872, -1.26536209898872,
                                                      -1.2908932882579, -1.315810418081, -1.34007831001118, -1.36366270220716,
                                                      -1.38653029780475, -1.40864881192596, -1.42998701725931, -1.45051478814717,
                                                      -1.47020314311766, -1.4890242858012, -1.50695164417395, -1.52395990807265,
                                                      -1.54002506492795, -1.55512443366579, -1.56923669672895, -1.58234193017356,
                                                      -1.59442163179804, -1.60545874726489, -1.61543769417827, -1.62434438408354,
                                                      -1.63216624235752, -1.63889222596166, -1.64451283903273, -1.64902014628927,
                                                      -1.65240778423477, -1.65467097014174, -1.65580650880409, -1.65581279704814,
                                                      -1.65468982599605, -1.65243918107831, -1.64906403979543, -1.64456916723186,
                                                      -1.63896090932862, -1.6322471839239, -1.6244374695746, -1.61554279217426,
                                                      -1.60557570938659, -1.59455029291625, -1.58248210864222, -1.56938819464162,
                                                      -1.55528703713501, -1.54019854438726, -1.52414401860066, -1.50714612584014,
                                                      -1.4892288640329, -1.47041752908769, -1.4507386791816, -1.4302200972648,
                                                      -1.40889075183601, -1.3867807560443, -1.36392132517481, -1.36392132517481,
                                                      -1.3867807560443, -1.40889075183601, -1.4302200972648, -1.4507386791816,
                                                      -1.47041752908769, -1.4892288640329, -1.50714612584014, -1.52414401860066,
                                                      -1.54019854438725, -1.55528703713501, -1.56938819464162, -1.58248210864222,
                                                      -1.59455029291625, -1.60557570938659, -1.61554279217426, -1.6244374695746,
                                                      -1.6322471839239, -1.63896090932862, -1.64456916723186, -1.64906403979543,
                                                      -1.65243918107831, -1.65468982599605, -1.65581279704814, -1.65580650880409,
                                                      -1.65467097014174, -1.65240778423477, -1.64902014628927, -1.64451283903273,
                                                      -1.63889222596166, -1.63216624235752, -1.62434438408354, -1.61543769417827,
                                                      -1.60545874726489, -1.59442163179804, -1.58234193017356, -1.56923669672895,
                                                      -1.55512443366579, -1.54002506492795, -1.52395990807265, -1.50695164417395,
                                                      -1.4890242858012, -1.47020314311766, -1.45051478814717, -1.42998701725931,
                                                      -1.40864881192596, -1.38653029780475, -1.36366270220716, -1.34007831001118,
                                                      -1.315810418081, -1.2908932882579, -1.26536209898872, -1.26536209898872,
                                                      -1.27575245890501, -1.28524643890542, -1.29383264259006, -1.30150076323708,
                                                      -1.30824159617475, -1.31404704983051, -1.318910155444, -1.32282507543221,
                                                      -1.32578711039679, -1.32779270476518, -1.32883945105856, -1.32892609278185,
                                                      -1.3280525259319, -1.32621979912238, -1.32343011232502, -1.31968681422882,
                                                      -1.31499439822034, -1.30935849698992, -1.30278587577028, -1.29528442421571,
                                                      -1.28686314693143, -1.27753215266462, -1.26730264217012, -1.25618689476518,
                                                      -1.24419825358964, -1.23135110958906, -1.21766088424007, -1.20314401103874,
                                                      -1.1878179157741, -1.17170099561053, -1.15481259700416, -1.13717299247972,
                                                      -1.11880335629581, -1.09972573902764, -1.079963041098, -1.05953898528793,
                                                      -1.03847808826042, -1.01680563113097, -0.99454762912065, -0.971730800327903,
                                                      -0.948382533656607, -0.924530855938952, -0.900204398292538, -0.875432361752106,
                                                      -0.850244482217151, -0.824670994757491, -0.798742597319642, -0.772490413877566,
                                                      -0.74594595707202, -0.719141090383363, -0.69210798988321)),
                  row.names = c(NA, -520L), class = c("data.frame"))
  cloud <- data.frame(
    x = xy$x/diff(range(xy$x))*size*asp + cx,
    y = xy$y/diff(range(xy$y))*size + cy
    )
  attr(cloud, "cpt_i") <- c(286, 239, 183, 130, 74,
                            26, 499, 443, 390, 334)
}

#' @export
build_rect <- function(cx, cy, size, asp = sqrt(2)){
  rect <- data.frame(
    x = c(-1/2, 0, 1/2, 1/2, 1/2, 0, -1/2, -1/2)*size*asp + cx,
    y = c(1/2,  1/2, 1/2, 0, -1/2, -1/2, -1/2, 0)*size + cy
    )
  attr(rect, "cpt_i") <- c(2, 4, 6, 8)
  return(rect)
}

#' @export
build_shape_xy <- function(data, coords){
  type <- data$type
  xy_list <- vector(mode = "list", length = length(coords$x))
  for(i in seq_along(coords$x)){
    if(type[i] %in% c("sink", "source")){
      xy_list[[i]] <- build_cloud(coords$x[i], coords$y[i], coords$size[i])
      xy_list[[i]]$id <- i
    }else if(type[i] == "state"){
      xy_list[[i]] <- build_rect(coords$x[i], coords$y[i], coords$size[i])
      xy_list[[i]]$id <- i
    }else{
      xy_list[[i]] <- NULL
    }
  }
  xy <- do.call(rbind, xy_list)

}
